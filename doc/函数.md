### 函数 ###

函数:将业务拆分为小单元,便于重复调用.隐藏实现细节.

#### 函数声明 ####

函数声明:函数名,形式参数列表,返回值列表(可省略),函数体;

	func name(parameter-list) (result-list) {
	    body
	}

形参由调用方提供,返回值省略表示没有返回值.返回值也可以像形参一样被命名,这时,返回值将被声明为局部变量,根据声明类型进行零值初始化.    
形参和返回值是否命名不影响函数实际运行;    
函数调用必须按声明顺序提供实参,go中不提供默认参数值,不允许通过参数名指定形参;    
形参和有名返回值作为函数最外层的局部变量,被存储在相同的语法块中;    
实参通过值的方式传递,因此函数的形参是实参的拷贝.对形参修改不影响实参.但可以通过引用类型的间接引用来修改实参.引用类型包括:指针,slice,map,function,channel等;    


#### 递归 ####

递归:函数可以自己间接或直接的调用自身的行为.递归有利于简化代码,实现抽象业务模型.

go使用可变栈,栈的大小按需增加,不用考虑递归栈溢出和安全问题.

	func outline(stack []string, n *html.Node) {
 	   if n.Type == html.ElementNode {
 	       stack = append(stack, n.Data) // push tag
 	       fmt.Println(stack)
 		}
  		for c := n.FirstChild; c != nil; c = c.NextSibling {
	        outline(stack, c)
	    }
	}

#### 多返回值 ####

go中,一个函数可以返回多个值.

	links, err := findLinks(url)

调用多返回值函数时,返回给调用者的是一组值,调用者必须显示的将这些值分配给变量.

	links, _ := findLinks(url) // errors ignored

不被使用的值使用_接收

良好的命名很重要.准确的变量名可以传达函数返回值的含义,尤其是相同返回值类型时.如果所有的返回值都有显示命名,则该函数的return语句可以省略操作数,这称为bare return

	func CountWordsAndImages(url string) (words, images int, err error) {
		resp, err := http.Get(url)
		if err != nil {
			return
		}
    	doc, err := html.Parse(resp.Body)
    	resp.Body.Close()
    	if err != nil {
        	err = fmt.Errorf("parsing HTML: %s", err)
        	return
    	}
	}

上面每个return等价于:return words, images, err.但是这种写法如果业务复杂时代码不直观,会增加出错几率.

#### 错误 ####
错误在所难免,也因此错误是程序的重要组成部分,程序运行失败仅被认为是几个预期的结果之一.

go的错误分为两种:    
程序不可控异常和panic异常.panic异常表示发生了某个已知bug.良好设计的程序不应该出现panic异常.实际go推荐在业务处理中自己处理panic异常,而go的异常机制用于处理不可控异常.

函数运行根据运行结果会返回额外的返回值用于判断执行是否成功的布尔值,这其实也是一种运行失败.但是这种情形一般不归类为异常,因为失败是在意料中的;    
发生异常的情况下,额外值将会是error类型,便于问题定位.error类型为nil表示函数运行成功,non-nil表示失败;    
non-nil情况下,其他返回值将是undefined未定义类型的值,这些值少数情况下可以起到数据定位的作用.    
运行中的错误信息go中认为是预期中的值而不是异常,只有未被意料到的错误才是go认为的异常,触发它的异常机制.如果将本身你就可以预知的错误返回给用户,繁复的堆栈信息反而让用户不知所措.

错误处理方式:

1. 传播.最常用方式,异常逐级上报,调用方进行处理;
2. 偶然性异常进行重试;
3. 输出错误信息并结束程序.适合程序无法继续运行时或会造成程序内部不一致时;
4. 非致命异常,只是日志输出,提示异常信息;
5. 忽略异常;不影响业务和使用;

文件结尾错误(EOF):io包保证任何由文件结束引起的读取失败都返回的错误.它是一种固定的错误信息.


















