### 测试 ###

测试:指自动化测试,写一些小程序用于检测代码行为是否符合预期.

go test命令:按照一定约定和组织来测试代码的程序.以_test.go结尾,它不会被go build构建到包内.

根据测试文件中有三类函数:

测试函数,基准测试函数,示例函数.

测试函数:以Test为函数前缀.验证逻辑是否正确;    
基准测试函数:以Benchmark为函数前缀,衡量函数性能;    
示例函数:以Example为函数前缀的函数.用于提供由编译器保证正确性的示例文档.


go test常用参数:

	-v: 显示执行测试函数名称和执行时间     
	-run:正则匹配执行函数.格式:go test -v -run 函数名

异常输出:t.Errorf输出不包括堆栈调用信息,也不会引起panic异常或停止测试执行.如果需要异常时停止执行需要使用t.Fatal或t.Fatalf.


**随机测试:**通过广泛的随机输入来测试探索函数的行为.验证方式:1对比验证;2根据值观的规则验证.随机测试可用于功能稳定性测试,便于探索系统问题.

**白盒测试:**与黑盒测试相对应.黑盒测试不需要了解被测试对象的内部工作原理,只根据文档和api行为即可完成测试,内部实现对测试代码是透明的.而白盒测试有访问内部函数和数据结构的权限,对外内部代码可操作.白盒测试便于替换部分业务逻辑,便于配置,预测和观察代码执行.如替换数据库连接,可以避免实际操作数据库等

**外部测试包:**解决go不允许循环依赖而将依赖抽取为独立包的行为.

![外部测试包](http://books.studygolang.com/gopl-zh/images/ch11-02.png)

查询go文件类型:

go list -f={{文件类型属性}} fmt //列举fmt包的指定文件类型文件

文件类型属性:    
	.GoFiles:产品代码    
	.TestGoFiles 内部测试代码    
	.XTestGoFiles 外部测试代码

当外部测试包需要引入产品代码时,通过白盒测试开放后门给外部测试包的方式,来避免循环依赖和代码的简洁性;    
如:fmt包通过export_test.go文件将内部方法暴露给外部测试:    

	package fmt
	
	var IsSpace = isSpace

测试的核心是:简洁高效的问题定位,包含信息包括:调用的具体函数,输入和结果的含义,打印实际值和期望值.


**基准测试:**衡量一个程序在固定工作负载下的性能.基准测试函数和普通测试函数写法类似,但是函数前缀是Benchmark,并且带有*testing.B类型参数.这个参数除了提供*testting.T类似方法外,还提供性能测量相关的方法.

go test -bench=执行函数名 -benchmem

基准测试必须指定才会执行,-bench用于指定执行函数;-benchmem用于输出内存分配情况.

输出:

BenchmarkIsPalindrome-4          6318978               193 ns/op             128 B/op          1 allocs/op


BenchmarkIsPalindrome执行函数名;4是运行时并发参数GOMAXPROCS的值;6318978是程序执行次数;193 ns/op一次操作花费0.193微妙;128一次内存分配花费128字节;1是进行了一次内存分配

**示例函数:**以Example开头的函数.它没有参数和返回值.
它的作用:    
1. 作为文档
2. 执行测试时,对比检查示例函数的标准输出与注释是否匹配
3. 提供实际的演练场





